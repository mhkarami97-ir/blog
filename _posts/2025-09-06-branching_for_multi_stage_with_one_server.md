---
title: "برنچینگ مورد نیاز برای داشتن چند پابلیش استیج با یک سرور"
categories:
  - Git
tags:
  - git
  - branch
  - stage
  - publish
  - jira
  - azure
---

از مشکلاتی که در تیم‌ها زمان کار کردن با Git و Jira و Scrum برای انجام کارها در صورتی که Definition Of Done تسک‌ها استیج باشد با آن ممکن است مواجه شوند، فلگ شدن تسک‌ها به علت عدم امکان پابلیش در استیج به علت نرفتن تسک‌های قبلی استیج به محیط Production است.  
دلیل خالی نبودن استیج نیز می‌تواند موارد مختلف مانند عدم تایید پابلیش Prod یا موارد دیگر باشد. از طرفی اگر تسک فعلی را نیز به محیط استیج ببرید تعداد تغییرات برای پابلیش Prod زیاد می‌شود که خود آن نیز باعث افزایش ریسک خطا در عملیات می‌شود.  
یکی از بهترین روش‌ها داشتن Docker, Kubernetes برای پابلیش استیج جدا هر نسخه و در واقع داشتن نسخه‌های مختلف استیج است که هر کدام جدا می‌تواند به Prod برود. اما بعضی مواقع به علت محدودیت‌ها این روش امکان‌پذیر نیست.  
در ادامه راه جایگزین برای برطرف کردن این مشکل که بتوانید کارهای را برای تست و تمام شدن به استیج ببرید و همچنین تسک‌های قبلی آن به عملیات نرفته باشد را با هم مرور می‌کنیم:  
پیش نیاز این روش داشتن دسترسی ایجاد Release جدید در ابزار Project Management Tool است.  
بطور مثال شما باید بتوانید از برنچ X یک Release جدید در ابزار AzureDevops یا Gitlab ایجاد کنید.  
در این حالت می‌توانید یک برنچ اصلی به اسم Main داشته باشید. برای هر کاری که قصد انجام آن در اسپرینت دارید می‌توانید یک Feature برنچ بگیرید.  
بطور مثال `feature/story-1234` که از این تسک افراد تیم User برنچ مانند `users/a.family` می‌گیرند و پول ریکوست خود را به همان فیچر می‌زنند.  
بعد از انجام کامل کار و زمان پابلیش می‌توانید یک برنچ جدید از فیچر تکمیل شده به اسم `release/v1.2.1` بگیرید و کارهایی که قصد پابلیش یکباره آنها را دارید را به آن پول ریکوست بزنید.  
پس در حال حاضر برنچ `v1.2.1` تمام تغییرات شما را دارد که می‌توانید آن را به محیط استیج پابلیش دهید.  
در صورتی که این تسک به Prod نرود می‌توانید مشابه روش بالا یک feature دیگر بسازید و آن را به استیچ پابلیش دهید.  
زمان رفتن به عملیات کافی است آخرین Artifact ساخته شده از Feature مورد نظر را به محیط Prod ببرید و سپس آن را در main مرج کنید.  

در صورتی که در محیط استیج به باگی خوردید کافی است از برنچ Release مورد نظر یک برنچ جدید بگیرید و کار خود را روی آن انجام دهید.  
در صورتی که از در محیط Prod به خطا خوردید با توجه به مرج شدن آن با main کافی است از برنچ main یک برنچ جدید بگیرید و سپس یک ریلیز جدید از آن ایجاد کنید.  

نمونه:  

```
-> main
        -> feature/story-1
            -> users/a.name/sub-task-1
            -> users/b.name/sub-task-2
        
        -> feature/story-2
            -> users/b.name/sub-task-4
        
        -> release/v1.0.0
            -> users/bug-fix/a.name/stage-bug-1

        -> release/v1.1.0

-> users/a.name/hot-fix/prod-bug-1
```
